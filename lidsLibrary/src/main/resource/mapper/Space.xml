<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lids.dao.SpaceDao">

    <!--  获取区域内的所有座位 -->
    <select id="selectSpacesByArea" resultType="com.lids.po.Space">
        SELECT * from space WHERE area_name = #{0}
    </select>

    <!-- 获取所有的区域 -->
    <select id="getAllAreas" resultType="com.lids.po.Area">
        SELECT * FROM area
    </select>

    <!-- 获取所有的座位状态 -->
    <select id="getSpacesStatus" resultType="com.lids.po.Space">
        SELECT * from space WHERE space_type_name = "标准座位"
    </select>

    <!--select space_id as spaceId,schedule_slot.begin_time as beginTime,duration-->
    <!--from schedule_slot inner join schedule-->
    <!--on schedule_slot.schedule_id = schedule.id-->
    <!--inner join space on `schedule`.space_id = space.id-->
    <!--where space.space_type_name = "标准研习间"-->
    <!--AND schedule.date = #{0}-->
    <!--ORDER BY space_id,schedule_slot.begin_time-->
    <select id="getRoomsSlot" resultType="java.util.Map">
      SELECT space_id as spaceId,begin_time as beginTime,end_time as endTime,application,user.name,application
      FROM booking_record INNER JOIN user ON booking_record.user_id = user.id
      WHERE is_room = "1"
      AND date = #{0}
      <!--<if test="date = CURRENT_DATE ">-->
        <!--AND end_time > CURRENT_TIME-->
      <!--</if>-->
    </select>

    <select id="getSeatSlot" resultType="java.util.Map">
        select space_id as spaceId,schedule_slot.begin_time as beginTime,duration
        from schedule_slot inner join schedule
        on schedule_slot.schedule_id = schedule.id
        inner join space on `schedule`.space_id = space.id
        where space.id = #{0}
        ORDER BY space_id,schedule_slot.begin_time
    </select>

    <!-- 获取指定座位的状态 -->
    <select id="getSeatById" resultType="com.lids.po.Space">
        SELECT  * FROM space
        WHERE id = #{0}
    </select>

    <select id="getSeatNameAndId" resultType="java.util.Map">
        SELECT id,name FROM space
        WHERE space_type_name = "标准研习间"
    </select>

</mapper>